<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Інструменти Google</title>
  <link rel="icon" type="image/x-icon" href="https://gmail24.netlify.app/icon.ico" />
  <style>
    /* VARIABLES */
    :root {
      --primary-color: #dc2625; /* Red-700 */
      --secondary-color: #ffffff;
      --background-color: #f5f5f7; 
      --text-color: #1d1d1f;
      --border-color: #e3e3e3; 
      --shadow-color: rgba(0, 0, 0, 0.05);
      --transition-duration: 0.2s;
    }

    /* BASE STYLES */
    * { 
      box-sizing: border-box; 
      font-family: 'SF Pro Text', 'SF Pro Icons', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif;
    }

    body {
      margin: 0;
      padding: 30px 20px;
      background: var(--background-color);
      color: var(--text-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 10vh;
      line-height: 1.5;
    }

    h2 {
      margin-top: 0;
      font-size: 20px; /* Уменьшен размер заголовка для узких колонок */
      font-weight: 600; 
      text-align: center;
      color: var(--text-color);
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border-color);
      margin-bottom: 20px;
    }

    /* LANGUAGE SELECTOR */
    .lang-selector {
      display: flex;
      gap: 15px;
      margin-bottom: 30px;
      justify-content: center;
    }

    .lang-selector button {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 15px;
      border: 1px solid var(--border-color);
      background-color: var(--secondary-color);
      border-radius: 10px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-color);
      box-shadow: 0 1px 3px var(--shadow-color);
      transition: all var(--transition-duration) ease;
    }

    .lang-selector button:hover {
      border-color: var(--primary-color);
      box-shadow: 0 2px 8px var(--shadow-color);
    }
    
    .lang-selector button:active {
      transform: scale(0.98); 
    }

    .lang-selector img {
      width: 20px;
      height: 14px;
      border-radius: 2px;
    }

    /* MAIN CONTENT CONTAINER for Horizontal Layout */
    .tool-container {
        display: flex;
        gap: 20px; /* Расстояние между окнами */
        width: 100%;
        /* Увеличена максимальная ширина для 4 колонок (4*320 + 3*gap) */
        max-width: 1380px; 
        justify-content: center;
        flex-wrap: wrap; /* Позволяет окнам переноситься на новую строку на маленьких экранах */
    }

    /* TOOL CARD (ОКНО) */
    .tool {
      background: var(--secondary-color);
      /* Фиксированная ширина для горизонтального размещения */
      width: 100%; 
      max-width: 320px; 
      margin: 10px 0; /* Убраны вертикальные отступы внутри контейнера */
      padding: 25px; /* Немного уменьшены внутренние отступы */
      border-radius: 18px; 
      box-shadow: 0 4px 12px var(--shadow-color), 0 1px 3px rgba(0, 0, 0, 0.05);
      display: flex;
      flex-direction: column;
      transition: transform var(--transition-duration) ease, box-shadow var(--transition-duration) ease; 
    }
    
    .tool:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
    }

    /* INPUTS & TEXTAREAS */
    input[type="text"],
    textarea,
    input[type="number"] { /* Добавлен стили для input type="number" */
      padding: 12px 15px; /* Немного уменьшены отступы */
      border: 1px solid var(--border-color);
      border-radius: 10px;
      font-size: 15px;
      margin-bottom: 15px;
      width: 100%;
      color: var(--text-color);
      background: var(--secondary-color);
      transition: border-color var(--transition-duration) ease, box-shadow var(--transition-duration) ease;
    }
    
    /* Стилизация для поля ввода количества логинов */
    #countInput {
        text-align: center;
    }


    input[type="text"]:focus,
    textarea:focus,
    input[type="number"]:focus { /* Добавлен стили для input type="number" */
      border-color: var(--primary-color);
      outline: none;
      box-shadow: 0 0 0 3px rgba(220, 38, 37, 0.15); 
    }

    .error-message {
      color: var(--primary-color);
      font-size: 13px; /* Немного уменьшен размер шрифта */
      margin-top: -10px;
      margin-bottom: 15px;
      font-weight: 500;
    }

    textarea {
      background: #fcfcfc;
      resize: vertical; 
      height: 150px; /* Уменьшена высота по умолчанию */
      min-height: 80px;
    }
    
    /* BUTTONS */
    .button-row {
      display: flex;
      flex-direction: column; /* Кнопки всегда вертикально для узких колонок */
      gap: 8px; 
      margin-bottom: 15px;
    }

    .button-row button {
      flex: 1;
      width: 100%; 
      padding: 14px 12px; /* Отступы для центрирования и удобства */
      text-align: center; 
      font-size: 15px; /* Немного уменьшен размер шрифта */
      font-weight: 600;
      color: var(--secondary-color);
      background: var(--primary-color);
      border: none;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(220, 38, 37, 0.2);
      transition: all var(--transition-duration) ease;
    }
    
    /* Secondary Button Style */
    .button-row button:not(:first-child) {
      background: #e9e9e9; 
      color: var(--text-color);
      box-shadow: none;
    }
    
    /* Стили для кнопок, которые не являются первой в ряду (для генератора логинов) */
    .tool:nth-child(3) .button-row button:first-child { 
        background: var(--primary-color);
        color: var(--secondary-color);
    }
    
    /* Стили для кнопок, которые не являются первой в ряду */
    .tool:nth-child(3) .button-row button:not(:first-child) { 
        background: #e9e9e9;
        color: var(--text-color);
    }
    
    /* Стили для кнопок, которые не являются первой в ряду (для нового укорочителя) */
    .tool:last-child .button-row button:first-child { 
        background: var(--primary-color);
        color: var(--secondary-color);
    }
    
    .tool:last-child .button-row button:not(:first-child) { 
        background: #e9e9e9;
        color: var(--text-color);
    }
    
    
    .button-row button:hover {
      opacity: 0.9;
      transform: translateY(-1px); 
    }
    
    .button-row button:active {
      transform: translateY(1px) scale(0.99); 
      box-shadow: 0 1px 2px rgba(220, 38, 37, 0.2);
    }
    
    /* Secondary Button Hover/Active */
    .button-row button:not(:first-child):hover {
      background: #d8d8d8;
      opacity: 1;
    }
    
    .tool:nth-child(3) .button-row button:not(:first-child):hover,
    .tool:last-child .button-row button:not(:first-child):hover {
        background: #d8d8d8;
    }
    

    /* EMAIL COUNTER */
    .email-counter {
      background: #f7f7f9; 
      padding: 10px; /* Немного уменьшен отступ */
      border: 1px solid var(--border-color);
      border-radius: 10px;
      text-align: center;
      font-size: 16px; /* Немного уменьшен размер шрифта */
      font-weight: 700;
      color: var(--primary-color); 
      margin-bottom: 15px;
    }
    
    /* LABEL STYLE */
    .input-label {
        font-size: 14px;
        font-weight: 500;
        color: var(--text-color);
        margin-bottom: 5px;
    }

    /* TOAST NOTIFICATION STYLES */
    #toastNotification {
      visibility: hidden; /* Скрыто по умолчанию */
      min-width: 250px;
      margin-left: -125px;
      background-color: var(--primary-color);
      color: var(--secondary-color);
      text-align: center;
      border-radius: 10px;
      padding: 16px;
      position: fixed;
      z-index: 10;
      left: 50%;
      bottom: 30px;
      font-size: 17px;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      opacity: 0;
      transition: visibility 0s, opacity 0.5s ease;
    }

    /* Класс для показа уведомления */
    #toastNotification.show {
      visibility: visible;
      opacity: 1;
      /* Добавим небольшую анимацию подъема */
      animation: fadein 0.5s, fadeout 0.5s 2.5s;
    }

    /* Анимация появления и исчезновения */
    @keyframes fadein {
      from {bottom: 0; opacity: 0;}
      to {bottom: 30px; opacity: 1;}
    }

    @keyframes fadeout {
      from {bottom: 30px; opacity: 1;}
      to {bottom: 0; opacity: 0;}
    }

    /* MEDIA QUERIES - Vertical layout for smaller screens */
    @media (max-width: 1390px) { /* Изменено для 4-х колонок (для 3-х колонок) */
        .tool-container {
            max-width: 1040px; /* 3 колонки */
        }
    }
    @media (max-width: 1060px) { /* Изменено для 3-х колонок (для 2-х колонок) */
        .tool-container {
            max-width: 700px; /* 2 колонки */
        }
    }
    
    @media (max-width: 740px) { /* Для 1 колонки */
      .tool-container {
        flex-direction: column;
        gap: 0;
        max-width: 400px; /* Ограничим ширину для лучшего вида на мобильных */
      }
      .tool {
        max-width: 100%; 
        margin: 15px 0;
      }
    }
  </style>
</head>
<body>
  <div class="lang-selector">
    <button onclick="setLanguage('uk')"><img src="https://flagcdn.com/w40/ua.png" alt="UK">UK</button>
    <button onclick="setLanguage('ru')"><img src="https://flagcdn.com/w40/ru.png" alt="RU">RU</button>
    <button onclick="setLanguage('en')"><img src="https://flagcdn.com/w40/us.png" alt="EN">EN</button>
    <button onclick="setLanguage('es')"><img src="https://flagcdn.com/w40/es.png" alt="ES">ES</button>
  </div>
  
  <div class="tool-container">
      <div class="tool">
        <h2 id="driveTitle">Пряма посилання Google Диска</h2>
        <input type="text" id="driveInput" placeholder="Вставьте ссылку на файл в Google Диске">
        <div class="button-row">
          <button onclick="convertDriveLink()" id="convertBtn">Преобразовать</button>
          <button onclick="copyDrive()" id="copyDriveBtn">Скопировать ссылку</button>
          <button onclick="goToDriveLink()" id="goToLinkBtn">Перейти по ссылке</button>
          <button onclick="shortenDriveLink()" id="shortenLinkBtn">Укоротить ссылку</button> 
        </div>
        <textarea id="driveOutput" placeholder="Прямая ссылка для скачивания" readonly></textarea>
      </div>
      
      <div class="tool">
        <h2 id="gmailTitle">Варіації пошти Gmail</h2>
        <input type="text" id="emailInput" placeholder="Введите Gmail логин или адрес, например dokyt56fg78" oninput="validateEmail()">
        <div id="emailError" class="error-message" style="display:none"></div>
        <div id="emailCounter" class="email-counter">Вариаций: 0</div>
        <div class="button-row">
          <button onclick="generateGmailVariations()" id="generateBtn">Сгенерировать</button>
          <button onclick="copyGmail()" id="copyBtn">Скопировать всё</button>
          <button onclick="downloadGmail()" id="downloadTxtBtn">Скачать .txt</button>
          <button onclick="downloadCSV()" id="downloadCsvBtn">Экспорт в CSV</button>
        </div>
        <textarea id="gmailOutput" placeholder="Здесь появятся варианты..." readonly></textarea>
      </div>
      
      <div class="tool">
        <h2 id="loginGenTitle">Генератор логінів Gmail</h2>
        <div class="input-label" id="countLabel">Кількість (1-50):</div>
        <input type="number" id="countInput" value="10" min="1" max="50" oninput="validateCountInput()">
        <div id="loginCountError" class="error-message" style="display:none"></div>
        
        <div class="input-label" id="lengthLabel">Длина логина (6-20):</div>
        <input type="number" id="lengthInput" value="10" min="6" max="20" oninput="validateLengthInput()">
        <div id="loginLengthError" class="error-message" style="display:none"></div>
        
        <div class="button-row">
          <button onclick="generateWordBasedLogins()" id="generateLoginBtn">Сгенерировать</button>
          <button onclick="copyLogins()" id="copyLoginsBtn">Скопировать всё</button>
        </div>
        <textarea id="loginOutput" placeholder="Здесь появятся короткие логины..." readonly></textarea>
      </div>
      
      <div class="tool">
        <h2 id="shortenerTitle">Укорочувач посилань</h2>
        <input type="text" id="shortenerInput" placeholder="Вставьте длинную ссылку">
        <input type="text" id="customIdInput" placeholder="Кастомный ID (опционально)">
        <div class="button-row">
          <button onclick="shortenCustomLink()" id="shortenCustomBtn">Укоротить</button>
          <button onclick="copyShortenedLink()" id="copyShortenedBtn">Скопировать</button>
        </div>
        <textarea id="shortenerOutput" placeholder="Укороченная ссылка появится здесь" readonly></textarea>
      </div>
      
  </div>
  
  <div id="toastNotification">Скопировано!</div>

  <script>
    // --- START: Existing Helper Functions (for XLSX, kept as is) ---
    var gk_isXlsx = false;
    var gk_xlsxFileLookup = {};
    var gk_fileData = {};
    function filledCell(cell) {
      return cell !== '' && cell != null;
    }
    function loadFileData(filename) {
      if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
        try {
          var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
          var firstSheetName = workbook.SheetNames[0];
          var worksheet = workbook.Sheets[firstSheetName];
          var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
          var filteredData = jsonData.filter(row => row.some(filledCell));
          var headerRowIndex = filteredData.findIndex((row, index) =>
            row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
          );
          if (headerRowIndex === -1 || headerRowIndex > 25) {
            headerRowIndex = 0;
          }
          var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex));
          csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
          return csv;
        } catch (e) {
          console.error(e);
          return "";
        }
      }
      return gk_fileData[filename] || "";
    }
    // --- END: Existing Helper Functions ---

    const translations = {
      ru: {
        gmailTitle: "Вариации почты Gmail",
        generateBtn: "Сгенерировать",
        copyBtn: "Скопировать всё",
        downloadTxtBtn: "Скачать .txt",
        downloadCsvBtn: "Экспорт в CSV",
        driveTitle: "Прямая ссылка Google Диска",
        convertBtn: "Преобразовать",
        copyDriveBtn: "Скопировать ссылку",
        goToLinkBtn: "Перейти по ссылке",
        shortenLinkBtn: "Укоротить ссылку", 
        emailCounter: "Вариаций: ",
        emailInputPlaceholder: "Введите Gmail логин или адрес, например dokyt56fg78",
        gmailOutputPlaceholder: "Здесь появятся варианты...",
        driveInputPlaceholder: "Вставьте ссылку на файл в Google Диске",
        driveOutputPlaceholder: "Прямая ссылка для скачивания",
        copySuccess: "Скопировано!",
        copyError: "Ошибка копирования: ",
        invalidEmailError: "Некорректный Gmail логин или адрес",
        noGmailDataError: "Нет данных для сохранения.",
        noGmailExportError: "Нет данных для экспорта.",
        invalidDriveLinkError: "Не удалось извлечь ID файла. Проверьте правильность ссылки.",
        noDriveLinkError: "Нет ссылки для перехода. Сначала преобразуйте ссылку.",
        noLinkToShortenError: "Нет ссылки для укорачивания. Сначала преобразуйте ссылку.", 
        shortenLinkError: "Ошибка при укорачивании ссылки. Проверьте ссылку.", 
        // НОВЫЕ ПЕРЕВОДЫ ДЛЯ ГЕНЕРАТОРА ЛОГИНОВ
        loginGenTitle: "Генератор логинов Gmail",
        countLabel: "Количество (1-50):",
        lengthLabel: "Длина логина (6-20):", 
        generateLoginBtn: "Сгенерировать",
        copyLoginsBtn: "Скопировать всё",
        loginOutputPlaceholder: "Здесь появятся короткие логины...",
        invalidCountError: "Количество должно быть от 1 до 50.",
        invalidLengthError: "Длина должна быть от 6 до 20 символов.", 
        noLoginsToCopyError: "Нет сгенерированных логинов для копирования.",
        // НОВЫЕ ПЕРЕВОДЫ ДЛЯ УКОРОТИТЕЛЯ
        shortenerTitle: "Укоротитель ссылок",
        shortenCustomBtn: "Укоротить",
        copyShortenedBtn: "Скопировать",
        shortenerInputPlaceholder: "Вставьте длинную ссылку",
        customIdInputPlaceholder: "Кастомный ID (опционально)",
        shortenerOutputPlaceholder: "Укороченная ссылка появится здесь",
        noLinkToShortenGeneralError: "Введите ссылку для укорачивания.",
        shortenGeneralError: "Ошибка при укорачивании ссылки:",
      },
      en: {
        gmailTitle: "Gmail Address Variations",
        generateBtn: "Generate",
        copyBtn: "Copy All",
        downloadTxtBtn: "Download .txt",
        downloadCsvBtn: "Export to CSV",
        driveTitle: "Direct Google Drive Link",
        convertBtn: "Convert",
        copyDriveBtn: "Copy Link",
        goToLinkBtn: "Go to Link",
        shortenLinkBtn: "Shorten Link", 
        emailCounter: "Variations: ",
        emailInputPlaceholder: "Enter Gmail login or address, e.g., dokyt56fg78",
        gmailOutputPlaceholder: "Variations will appear here...",
        driveInputPlaceholder: "Paste the Google Drive file link",
        driveOutputPlaceholder: "Direct download link",
        copySuccess: "Copied!",
        copyError: "Copy error: ",
        invalidEmailError: "Invalid Gmail login or address",
        noGmailDataError: "No data to save.",
        noGmailExportError: "No data to export.",
        invalidDriveLinkError: "Failed to extract file ID. Check the link.",
        noDriveLinkError: "No link to navigate to. Convert the link first.",
        noLinkToShortenError: "No link to shorten. Convert the link first.", 
        shortenLinkError: "Error shortening link. Check the link.", 
        // НОВЫЕ ПЕРЕВОДЫ ДЛЯ ГЕНЕРАТОРА ЛОГИНОВ
        loginGenTitle: "Gmail Login Generator",
        countLabel: "Count (1-50):",
        lengthLabel: "Login Length (6-20):", 
        generateLoginBtn: "Generate",
        copyLoginsBtn: "Copy All",
        loginOutputPlaceholder: "Short logins will appear here...",
        invalidCountError: "Count must be between 1 and 50.",
        invalidLengthError: "Length must be between 6 and 20 characters.", 
        noLoginsToCopyError: "No generated logins to copy.",
        // НОВЫЕ ПЕРЕВОДЫ ДЛЯ УКОРОТИТЕЛЯ
        shortenerTitle: "Link Shortener",
        shortenCustomBtn: "Shorten",
        copyShortenedBtn: "Copy",
        shortenerInputPlaceholder: "Paste long link",
        customIdInputPlaceholder: "Custom ID (optional)",
        shortenerOutputPlaceholder: "Shortened link will appear here",
        noLinkToShortenGeneralError: "Enter a link to shorten.",
        shortenGeneralError: "Error shortening link:",
      },
      es: {
        gmailTitle: "Variaciones de Gmail",
        generateBtn: "Generar",
        copyBtn: "Copiar todo",
        downloadTxtBtn: "Descargar .txt",
        downloadCsvBtn: "Exportar a CSV",
        driveTitle: "Enlace directo de Google Drive",
        convertBtn: "Convertir",
        copyDriveBtn: "Copiar enlace",
        goToLinkBtn: "Ir al enlace",
        shortenLinkBtn: "Acortar enlace", 
        emailCounter: "Variaciones: ",
        emailInputPlaceholder: "Ingrese el login o dirección de Gmail, por ejemplo, dokyt56fg78",
        gmailOutputPlaceholder: "Las variaciones aparecerán aquí...",
        driveInputPlaceholder: "Pegue el enlace del archivo de Google Drive",
        driveOutputPlaceholder: "Enlace de descarga directa",
        copySuccess: "¡Copiado!", 
        copyError: "Error al copiar: ",
        invalidEmailError: "Login o dirección de Gmail no válida",
        noGmailDataError: "No hay datos para guardar.",
        noGmailExportError: "No hay datos para exportar.",
        invalidDriveLinkError: "No se pudo extraer el ID del archivo. Verifique el enlace.",
        noDriveLinkError: "No hay enlace para navegar. Convierta el enlace primero.",
        noLinkToShortenError: "No hay enlace para acortar. Convierta el enlace primero.", 
        shortenLinkError: "Error al acortar el enlace. Verifique el enlace.", 
        // НОВЫЕ ПЕРЕВОДЫ ДЛЯ ГЕНЕРАТОРА ЛОГИНОВ
        loginGenTitle: "Generador de Login de Gmail",
        countLabel: "Cantidad (1-50):",
        lengthLabel: "Longitud del Login (6-20):", 
        generateLoginBtn: "Generar",
        copyLoginsBtn: "Copiar todo",
        loginOutputPlaceholder: "Los logins cortos aparecerán aquí...",
        invalidCountError: "La cantidad debe estar entre 1 y 50.",
        invalidLengthError: "La longitud debe ser entre 6 и 20 caracteres.", 
        noLoginsToCopyError: "No hay logins generados para copiar.",
        // НОВЫЕ ПЕРЕВОДЫ ДЛЯ УКОРОТИТЕЛЯ
        shortenerTitle: "Acortador de Enlaces",
        shortenCustomBtn: "Acortar",
        copyShortenedBtn: "Copiar",
        shortenerInputPlaceholder: "Pegue el enlace largo",
        customIdInputPlaceholder: "ID personalizado (opcional)",
        shortenerOutputPlaceholder: "El enlace acortado aparecerá aquí",
        noLinkToShortenGeneralError: "Ingrese un enlace para acortar.",
        shortenGeneralError: "Error al acortar el enlace:",
      },
      uk: { 
        gmailTitle: "Варіації пошти Gmail",
        generateBtn: "Згенерувати",
        copyBtn: "Скопіювати все",
        downloadTxtBtn: "Завантажити .txt",
        downloadCsvBtn: "Експорт у CSV",
        driveTitle: "Пряме посилання Google Диска",
        convertBtn: "Перетворити",
        copyDriveBtn: "Скопіювати посилання",
        goToLinkBtn: "Перейти за посиланням",
        shortenLinkBtn: "Скоротити посилання", 
        emailCounter: "Варіацій: ",
        emailInputPlaceholder: "Введіть логін або адресу Gmail, наприклад dokyt56fg78",
        gmailOutputPlaceholder: "Тут з'являться варіанти...",
        driveInputPlaceholder: "Вставте посилання на файл у Google Диску",
        driveOutputPlaceholder: "Пряме посилання для завантаження",
        copySuccess: "Скопійовано!", 
        copyError: "Помилка копіювання: ",
        invalidEmailError: "Некоректний логін або адреса Gmail",
        noGmailDataError: "Немає даних для збереження.",
        noGmailExportError: "Немає даних для експорту.",
        invalidDriveLinkError: "Не вдалося витягти ID файлу. Перевірте правильність посилання.",
        noDriveLinkError: "Немає посилання для переходу. Спершу перетворіть посилання.",
        noLinkToShortenError: "Немає посилання для скорочення. Спершу перетворіть посилання.", 
        shortenLinkError: "Помилка при скороченні посилання. Перевірте посилання.",
        // НОВЫЕ ПЕРЕВОДЫ ДЛЯ ГЕНЕРАТОРА ЛОГИНОВ
        loginGenTitle: "Генератор логінів Gmail",
        countLabel: "Кількість (1-50):",
        lengthLabel: "Довжина логіна (6-20):", 
        generateLoginBtn: "Згенерувати",
        copyLoginsBtn: "Скопіювати все",
        loginOutputPlaceholder: "Тут з'являться короткі логіни...",
        invalidCountError: "Кількість має бути від 1 до 50.",
        invalidLengthError: "Довжина має бути від 6 до 20 символів.", 
        noLoginsToCopyError: "Немає згенерованих логінів для копіювання.",
        // НОВЫЕ ПЕРЕВОДЫ ДЛЯ УКОРОТИТЕЛЯ
        shortenerTitle: "Укорочувач посилань",
        shortenCustomBtn: "Укоротити",
        copyShortenedBtn: "Скопіювати",
        shortenerInputPlaceholder: "Вставте довге посилання",
        customIdInputPlaceholder: "Кастомний ID (опціонально)",
        shortenerOutputPlaceholder: "Скорочене посилання з'явиться тут",
        noLinkToShortenGeneralError: "Введіть посилання для скорочення.",
        shortenGeneralError: "Помилка при скороченні посилання:",
      }
    };

    let toastTimer;

    // ФУНКЦИЯ ДЛЯ ОТОБРАЖЕНИЯ УВЕДОМЛЕНИЯ
    function showToast(message) {
        // Очищаем предыдущий таймер, если он есть
        clearTimeout(toastTimer);
        const toast = document.getElementById("toastNotification");
        toast.innerText = message;
        toast.className = "show";
        // Запускаем новый таймер для скрытия
        toastTimer = setTimeout(function(){ 
          toast.className = toast.className.replace("show", ""); 
        }, 3000);
    }


    function setLanguage(lang) {
      document.documentElement.lang = lang;
      const t = translations[lang];
      document.getElementById("gmailTitle").innerText = t.gmailTitle;
      document.getElementById("generateBtn").innerText = t.generateBtn;
      document.getElementById("copyBtn").innerText = t.copyBtn;
      document.getElementById("downloadTxtBtn").innerText = t.downloadTxtBtn;
      document.getElementById("downloadCsvBtn").innerText = t.downloadCsvBtn;
      document.getElementById("driveTitle").innerText = t.driveTitle;
      document.getElementById("convertBtn").innerText = t.convertBtn;
      document.getElementById("copyDriveBtn").innerText = t.copyDriveBtn;
      document.getElementById("goToLinkBtn").innerText = t.goToLinkBtn;
      document.getElementById("shortenLinkBtn").innerText = t.shortenLinkBtn; 
      const currentCount = document.getElementById("gmailOutput").value.split('\n').filter(Boolean).length;
      document.getElementById("emailCounter").innerText = t.emailCounter + currentCount;
      document.getElementById("emailInput").placeholder = t.emailInputPlaceholder;
      document.getElementById("gmailOutput").placeholder = t.gmailOutputPlaceholder;
      document.getElementById("driveInput").placeholder = t.driveInputPlaceholder;
      document.getElementById("driveOutput").placeholder = t.driveOutputPlaceholder;
      document.getElementById("toastNotification").innerText = t.copySuccess; 
      
      // ОБНОВЛЕНИЕ ДЛЯ ГЕНЕРАТОРА ЛОГИНОВ
      document.getElementById("loginGenTitle").innerText = t.loginGenTitle;
      document.getElementById("countLabel").innerText = t.countLabel;
      document.getElementById("lengthLabel").innerText = t.lengthLabel;
      document.getElementById("generateLoginBtn").innerText = t.generateLoginBtn;
      document.getElementById("copyLoginsBtn").innerText = t.copyLoginsBtn;
      document.getElementById("loginOutput").placeholder = t.loginOutputPlaceholder;
      
      // ОБНОВЛЕНИЕ ДЛЯ НОВОГО УКОРОТИТЕЛЯ
      document.getElementById("shortenerTitle").innerText = t.shortenerTitle;
      document.getElementById("shortenCustomBtn").innerText = t.shortenCustomBtn;
      document.getElementById("copyShortenedBtn").innerText = t.copyShortenedBtn;
      document.getElementById("shortenerInput").placeholder = t.shortenerInputPlaceholder;
      document.getElementById("customIdInput").placeholder = t.customIdInputPlaceholder;
      document.getElementById("shortenerOutput").placeholder = t.shortenerOutputPlaceholder;
    }
    
    document.addEventListener('DOMContentLoaded', () => {
        setLanguage('uk');
    });

    async function copyToClipboard(text) {
      const lang = document.documentElement.lang || 'uk';
      const t = translations[lang];
      try {
        await navigator.clipboard.writeText(text);
        showToast(t.copySuccess); 
      } catch (err) {
        alert(t.copyError + err);
      }
    }
    
    // --- ИЗМЕНЕННАЯ ФУНКЦИЯ validateEmail() ---
    function validateEmail() {
      const emailField = document.getElementById("emailInput");
      const errorField = document.getElementById("emailError");
      const input = emailField.value.trim().toLowerCase();
      const lang = document.documentElement.lang || 'uk';
      const t = translations[lang];
      
      if (!input) {
          emailField.classList.remove("invalid");
          errorField.style.display = "none";
          return;
      }

      // Если введен полный email, проверяем его.
      // Если введен только логин (нет @), проверяем только логин.
      const isFullEmail = input.includes('@');
      let localPart;
      
      if (isFullEmail) {
          // Проверяем формат полного адреса (user@gmail.com)
          const fullEmailRegex = /^([a-z0-9]+(\.?[a-z0-9]+)*)@(gmail|googlemail)\.com$/;
          if (!fullEmailRegex.test(input)) {
              localPart = ""; // Некорректный адрес
          } else {
              localPart = input.split("@")[0];
          }
      } else {
          // Проверяем формат логина (только a-z, 0-9 и точка)
          const loginRegex = /^[a-z0-9]+(\.?[a-z0-9]+)*$/;
          if (!loginRegex.test(input)) {
              localPart = ""; // Некорректный логин
          } else {
              localPart = input;
          }
      }

      // Дополнительные правила Gmail: не начинается/заканчивается точкой, нет двойных точек.
      // Также проверяем минимальную длину - 6 символов
      const isValidLocalPart = localPart && localPart.length >= 6 && /^(?!\.).*(?<!\.)$/.test(localPart) && !localPart.includes("..");
      const isValid = isFullEmail ? (localPart && isValidLocalPart) : (localPart && isValidLocalPart);
      
      if (!isValid) {
        emailField.classList.add("invalid");
        errorField.style.display = "block";
        errorField.innerText = t.invalidEmailError;
      } else {
        emailField.classList.remove("invalid");
        errorField.style.display = "none";
      }
    }
    // --- КОНЕЦ ИЗМЕНЕННОЙ ФУНКЦИИ validateEmail() ---

    // --- ИЗМЕНЕННАЯ ФУНКЦИЯ generateGmailVariations() ---
    function generateGmailVariations() {
      let email = document.getElementById("emailInput").value.trim().toLowerCase();
      const output = document.getElementById("gmailOutput");
      const counter = document.getElementById("emailCounter");
      const lang = document.documentElement.lang || 'uk';
      const t = translations[lang];
      output.value = "";
      
      // Автоматически добавляем @gmail.com, если это только логин
      if (email && !email.includes('@')) {
          email = email + "@gmail.com";
      }
      
      const localPart = email.split("@")[0];
      
      // Повторная валидация, но уже с полным адресом (на случай, если пользователь ввел логин)
      const fullEmailRegex = /^([a-z0-9]+(\.?[a-z0-9]+)*)@(gmail|googlemail)\.com$/;
      const isValid = fullEmailRegex.test(email) && localPart.length >= 6 && /^(?!\.).*(?<!\.)$/.test(localPart) && !localPart.includes("..");
      
      if (!isValid) {
        validateEmail();
        counter.innerText = t.emailCounter + "0";
        return;
      }

      const local = email.split("@")[0].replace(/\./g, ''); 
      const variations = new Set();
      const positions = [];

      for (let i = 1; i < local.length; i++) positions.push(i);

      const totalCombos = Math.pow(2, positions.length);

      for (let i = 0; i < totalCombos; i++) {
        let parts = [], last = 0;
        for (let j = 0; j < positions.length; j++) {
          if (i & (1 << j)) {
            parts.push(local.slice(last, positions[j]));
            last = positions[j];
          }
        }
        parts.push(local.slice(last));
        const dotted = parts.join(".");
        
        // Повторная проверка правил точек (должно быть лишним после проверки выше, но для надежности)
        if (dotted.length >= 6 && /^(?!\.).*(?<!\.)$/.test(dotted) && !dotted.includes("..")) {
          variations.add(dotted + "@gmail.com");
          variations.add(dotted + "@googlemail.com");
        }
      }

      const variationList = Array.from(variations).sort();
      output.value = variationList.join("\n");
      counter.innerText = t.emailCounter + variationList.length;
    }
    // --- КОНЕЦ ИЗМЕНЕННОЙ ФУНКЦИИ generateGmailVariations() ---

    function copyGmail() {
      const text = document.getElementById("gmailOutput").value;
      copyToClipboard(text);
    }

    function downloadTextFile(filename, content) {
      const blob = new Blob([content], { type: 'text/plain;charset=utf-utf-8' });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = filename;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    function downloadGmail() {
      const text = document.getElementById("gmailOutput").value;
      const lang = document.documentElement.lang || 'uk';
      const t = translations[lang];
      if (!text.trim()) {
        alert(t.noGmailDataError);
        return;
      }
      downloadTextFile("gmail_variations.txt", text);
    }

    function downloadCSV() {
      const text = document.getElementById("gmailOutput").value;
      const lang = document.documentElement.lang || 'uk';
      const t = translations[lang];
      if (!text.trim()) {
        alert(t.noGmailExportError);
        return;
      }
      const lines = text.split('\n').filter(Boolean);
      const csvContent = "data:text/csv;charset=utf-8," 
                        + "Email Variation\n" 
                        + lines.map(line => `"${line}"`).join("\n");
      const encodedUri = encodeURI(csvContent);
      const link = document.createElement("a");
      link.setAttribute("href", encodedUri);
      link.setAttribute("download", "gmail_variations.csv");
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    function convertDriveLink() {
      const input = document.getElementById("driveInput").value.trim();
      const output = document.getElementById("driveOutput");
      const lang = document.documentElement.lang || 'uk';
      const t = translations[lang];
      const match = input.match(/(?:\/d\/|id=|\/file\/d\/|drive\.google\.com\/(?:file\/d\/|open\?id=))([a-zA-Z0-9_-]{10,})/);
      if (match && match[1]) {
        const fileId = match[1];
        output.value = `https://drive.google.com/uc?export=download&id=${fileId}`;
      } else {
        output.value = "";
        alert(t.invalidDriveLinkError);
      }
    }

    function copyDrive() {
      const text = document.getElementById("driveOutput").value;
      copyToClipboard(text);
    }

    function goToDriveLink() {
      const link = document.getElementById("driveOutput").value.trim();
      const lang = document.documentElement.lang || 'uk';
      const t = translations[lang];
      if (link) {
        window.open(link, '_blank');
      } else {
        alert(t.noDriveLinkError);
      }
    }
    
    // ФУНКЦИЯ ДЛЯ УКОРАЧИВАНИЯ ССЫЛКИ С ИСПОЛЬЗОВАНИЕМ is.gd
    async function shortenLink(longUrl, outputElementId, customId = null) {
      const output = document.getElementById(outputElementId);
      const lang = document.documentElement.lang || 'uk';
      const t = translations[lang];
      
      if (!longUrl) {
          alert(t.noLinkToShortenError); // Используем общую ошибку для Drive
          return;
      }
      
      let apiEndpoint = `https://is.gd/create.php?format=json&url=${encodeURIComponent(longUrl)}`;
      
      // Добавляем кастомный ID, если он есть
      if (customId) {
          apiEndpoint += `&shorturl=${encodeURIComponent(customId)}`;
      }

      try {
        const response = await fetch(apiEndpoint);
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }

        const data = await response.json();
        
        if (data.shorturl) {
          output.value = data.shorturl;
          showToast(t.copySuccess); 
        } else if (data.error) {
          throw new Error(data.error);
        } else {
          throw new Error("Неизвестный ответ от сервиса укорачивания.");
        }
      } catch (error) {
        // Для Drive используем специфичную ошибку
        const errorMessage = outputElementId === "driveOutput" 
                           ? t.shortenLinkError 
                           : t.shortenGeneralError;
        alert(`${errorMessage} ${error.message || ""}`); 
      }
    }
    
    // ФУНКЦИЯ, ВЫЗЫВАЕМАЯ КНОПКОЙ "Укоротить ссылку" для Google Drive
    async function shortenDriveLink() {
      const link = document.getElementById("driveOutput").value.trim();
      await shortenLink(link, "driveOutput");
    }
    
    // ===============================================
    // НОВЫЕ ФУНКЦИИ ДЛЯ ГЕНЕРАТОРА ЛОГИНОВ
    // ===============================================
    
    function validateCountInput() {
        const countInput = document.getElementById("countInput");
        const errorField = document.getElementById("loginCountError");
        const lang = document.documentElement.lang || 'uk';
        const t = translations[lang];
        
        let count = parseInt(countInput.value, 10);
        
        if (isNaN(count) || count < 1 || count > 50) {
            errorField.innerText = t.invalidCountError;
            errorField.style.display = "block";
            // Ограничиваем ввод, но не сбрасываем, чтобы пользователь мог исправить
            if (count < 1) countInput.value = 1;
            if (count > 50) countInput.value = 50;
        } else {
            errorField.style.display = "none";
        }
    }
    
    function validateLengthInput() {
        const lengthInput = document.getElementById("lengthInput");
        const errorField = document.getElementById("loginLengthError");
        const lang = document.documentElement.lang || 'uk';
        const t = translations[lang];
        
        let length = parseInt(lengthInput.value, 10);
        
        // МАКСИМАЛЬНАЯ ДЛИНА 20
        if (isNaN(length) || length < 6 || length > 20) {
            errorField.innerText = t.invalidLengthError;
            errorField.style.display = "block";
            // Ограничиваем ввод
            if (length < 6) lengthInput.value = 6;
            if (length > 20) lengthInput.value = 20;
        } else {
            errorField.style.display = "none";
        }
    }
    
    // Вспомогательная функция для получения случайного элемента из массива
    function getRandomItem(array) {
        return array[Math.floor(Math.random() * array.length)];
    }
    
    // ОБНОВЛЕННЫЙ СПИСОК СЛОВ: добавлен юмор, ирония, и "мемные" слова.
    const wordList = [
        // Нейтральные слова, имена и популярные основы
        "quick", "smart", "happy", "lucky", "fresh", "cool", "fire", "ice",
        "star", "sky", "cloud", "sun", "moon", "wave", "peak", "zone", "game",
        "book", "note", "key", "link", "code", "data", "byte", "mega", "pro", "master",
        "max", "neo", "alex", "mila", "leo", "nina", "june", "nova", "power", "speed", 
        "turbo", "logic", "dream", "quest", "elite", "prime", "optic", "delta",
        
        // Смешные/Ироничные/Необычные слова (для юмора)
        "potato", "ninja", "bacon", "fluffy", "shush", "oops", "yikes", "sushi",
        "waffle", "socks", "ghost", "noodle", "zebra", "squid", "troll", "bot",
        "fail", "epic", "weird", "hello", "yolo", "oof", "giga", "hacker", "banana", "pickle"
    ];

    /**
     * Генерирует логины на основе слов из wordList, комбинируя их с цифрами.
     */
    function generateWordBasedLogins() {
        const output = document.getElementById("loginOutput");
        
        validateCountInput();
        validateLengthInput();
        
        const countInput = document.getElementById("countInput");
        const lengthInput = document.getElementById("lengthInput");
        
        const count = parseInt(countInput.value, 10);
        const targetLength = parseInt(lengthInput.value, 10);

        if (isNaN(count) || count < 1 || count > 50 || isNaN(targetLength) || targetLength < 6 || targetLength > 20) {
            output.value = "";
            return;
        }
        
        const digits = '0123456789';
        
        const generatedLogins = new Set();
        let attempts = 0;
        const maxAttempts = count * 100;

        while (generatedLogins.size < count && attempts < maxAttempts) {
            let baseWord = getRandomItem(wordList);
            let login = '';
            
            // Если длина слова уже больше или равна целевой, обрезаем и добавляем 1-2 цифры
            if (baseWord.length >= targetLength - 2) {
                // Берем максимум (targetLength - 1), чтобы осталось место для цифры
                const maxWordLen = Math.min(baseWord.length, targetLength - 2); 
                baseWord = baseWord.substring(0, maxWordLen);
                login = baseWord;
                // Добавляем минимум 2 цифры для уникальности и выполнения минимальной длины
                const numDigits = targetLength - login.length;
                for (let i = 0; i < numDigits; i++) {
                    login += getRandomItem(digits);
                }
            } else {
                // Слово короче целевой длины, заполняем остаток.
                const remainingLength = targetLength - baseWord.length;
                
                // 1. Используем либо второе слово, либо цифры.
                if (remainingLength >= 5 && Math.random() < 0.6) { // 60% шанс на два слова
                    let secondWord = getRandomItem(wordList);
                    let combined = baseWord + secondWord;
                    
                    if (combined.length <= targetLength - 2) {
                        login = combined;
                        const numDigits = targetLength - login.length;
                        for (let i = 0; i < numDigits; i++) {
                             login += getRandomItem(digits);
                        }
                    } else {
                        // Если 2 слова слишком длинные, обрезаем второе и добавляем цифры
                        const remainingSpace = targetLength - baseWord.length - 2; // -2 для мин. 2 цифр
                        const maxSecondWordLen = Math.max(0, remainingSpace);
                        combined = baseWord + secondWord.substring(0, maxSecondWordLen);
                        login = combined;
                        
                        const numDigits = targetLength - login.length;
                        for (let i = 0; i < numDigits; i++) {
                             login += getRandomItem(digits);
                        }
                    }
                } else {
                    // 2. Только одно слово + цифры для оставшейся длины
                    login = baseWord;
                    for (let i = 0; i < remainingLength; i++) {
                        login += getRandomItem(digits);
                    }
                }
            }

            // Финальная проверка длины и уникальности
            login = login.substring(0, targetLength);
            // Убеждаемся, что в логине есть хотя бы одна цифра (для уникальности)
            if (login.length >= 6 && /[0-9]/.test(login)) { 
                generatedLogins.add(login);
            }
            attempts++;
        }
        
        const loginList = Array.from(generatedLogins).sort();
        output.value = loginList.join("\n");
    }

    function copyLogins() {
        const text = document.getElementById("loginOutput").value;
        const lang = document.documentElement.lang || 'uk';
        const t = translations[lang];
        
        if (!text.trim()) {
            alert(t.noLoginsToCopyError);
            return;
        }
        copyToClipboard(text);
    }
    
    // ===============================================
    // КОНЕЦ НОВЫХ ФУНКЦИЙ ДЛЯ ГЕНЕРАТОРА ЛОГИНОВ
    // ===============================================

    // ===============================================
    // НОВЫЕ ФУНКЦИИ ДЛЯ УКОРОТИТЕЛЯ ССЫЛОК
    // ===============================================
    
    async function shortenCustomLink() {
        const longUrl = document.getElementById("shortenerInput").value.trim();
        const customId = document.getElementById("customIdInput").value.trim();
        const output = document.getElementById("shortenerOutput");
        const lang = document.documentElement.lang || 'uk';
        const t = translations[lang];
        
        output.value = ""; // Очищаем поле вывода
        
        if (!longUrl) {
            alert(t.noLinkToShortenGeneralError);
            return;
        }
        
        await shortenLink(longUrl, "shortenerOutput", customId);
    }
    
    function copyShortenedLink() {
        const text = document.getElementById("shortenerOutput").value;
        const lang = document.documentElement.lang || 'uk';
        const t = translations[lang];
        
        if (!text.trim()) {
            alert(t.noLinkToShortenGeneralError); // Используем эту ошибку, так как нет сгенерированной ссылки
            return;
        }
        copyToClipboard(text);
    }

    // ===============================================
    // КОНЕЦ НОВЫХ ФУНКЦИЙ ДЛЯ УКОРОТИТЕЛЯ ССЫЛОК
    // ===============================================

  </script>
</body>
</html>